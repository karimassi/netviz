"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}var SankeyMood=function(){function e(t){_classCallCheck(this,e),this.svg=t,this.currentData={},this.MONTHS=[],this.width=0,this.height=0,this.margin={},this.setup()}return _createClass(e,[{key:"setup",value:function(){this.width=1100,this.height=600,this.margin={top:40,right:115,bottom:50,left:100},this.svg.attr("viewBox","0 -10 ".concat(this.width," ").concat(this.height)),this.svg=this.svg.append("g").attr("transform","translate(125,0)")}},{key:"createSankey",value:function(){function e(t){return r(t)+" Items"}var n=["January","February","March","April","May","June","July","August","September","October","November","December"],r=d3.format(",.0f"),a=d3.sankey().nodeWidth(20).nodePadding(10).size([this.width-this.margin.right-this.margin.left,this.height-this.margin.bottom-this.margin.top]),i=a.link(),s={nodes:[],links:[]};this.currentData.forEach(function(t){s.nodes.push({name:n[t.source-1]}),s.nodes.push({name:t.target}),s.links.push({source:n[t.source-1],target:t.target,value:+t.value})}),s.nodes=d3.keys(d3.nest().key(function(t){return t.name}).object(s.nodes)),s.links.forEach(function(t,e){s.links[e].source=s.nodes.indexOf(s.links[e].source),s.links[e].target=s.nodes.indexOf(s.links[e].target)}),s.nodes.forEach(function(t,e){s.nodes[e]={name:t}}),a.nodes(s.nodes).links(s.links).layout(32);var o=this.svg.append("g").selectAll(".link").data(s.links).enter().append("path").attr("class","link").attr("d",i).style("stroke-width",function(t){return Math.max(2,t.dy)}).sort(function(t,e){return e.dy-t.dy});o.append("title").text(function(t){return t.source.name+" â†’ "+t.target.name+"\n"+e(t.value)});var t=this.svg.append("g").selectAll(".node").data(s.nodes).enter().append("g").attr("class","node").attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).call(d3.drag().subject(function(t){return t}).on("start",function(){this.parentNode.appendChild(this)}).on("drag",function(t){d3.select(this).attr("transform","translate("+t.x+","+(t.y=Math.max(0,Math.min(sizeY-t.dy,d3.event.y)))+")"),a.relayout(),o.attr("d",i)}));t.append("rect").attr("height",function(t){return t.dy}).attr("width",a.nodeWidth()).style("fill",function(t){return t.color="#db0000"}).style("stroke",function(t){return d3.rgb(t.color).darker(2)}).append("title").text(function(t){return t.name+"\n"+e(t.value)}),t.append("text").attr("x",25).attr("y",function(t){return t.dy/2}).attr("dy",".35em").attr("text-anchor","start").style("font-size","0.8em").attr("transform",null).text(function(t){return t.name}).filter(function(t){return t.x<550}).attr("x",-10).attr("text-anchor","end").style("font-size","0.8em")}}]),e}();function instantiateMoodSankey(t,e){var n=new SankeyMood(t);d3.csv(e).then(function(t){n.currentData=t,n.createSankey()})}$(function(){instantiateMoodSankey(d3.select("svg#mood"),"data/mood.csv")});
//# sourceMappingURL=genres_sankey.js.map
