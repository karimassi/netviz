{"version":3,"sources":["busiest_month_bar.js"],"names":["BusiestMonthStackedBarPlot","svgElement","_classCallCheck","this","svg","currentData","MONTHS","width","height","setup","d3","scaleBand","x","xScale","append","attr","call","axisBottom","selectAll","style","scaleLinear","domain","range","y","yScale","transition","duration","scaleOrdinal","columns","types","slice","stack","keys","select","createColorRange","data","enter","initiateBars","d","bandwidth","concat","createYaxis","subgroupName","tooltip","subgroupValue","event","mouseleave","createTooltips","instentiateBusiestMonth","loadedData","stackedData","showInitialPlot","color","key","delay","data_path","then","month","forEach","total","parseInt","movie","parentNode","datum","html","updateData","plot","csv","show","map"],"mappings":"uZAAMA,2B,WACF,SAAAA,EAAYC,GAAYC,gBAAAC,KAAAH,GACpBG,KAAKC,IAAMH,EACXE,KAAKE,YAAc,GACnBF,KAAKG,OAAS,GACdH,KAAKI,MAAQ,EACbJ,KAAKK,OAAS,EACdL,KAAKM,Q,2CANe,WAUpB,OAAOC,GAAGC,YATLP,OAAMH,KAAAA,QACNI,MAAAA,CAAAA,EAALF,KAAAI,QACKD,QAAL,M,yBAGA,WACH,IAAAM,EAAAT,KAAAU,OAAAV,KAAAI,OAYGJ,KAAKC,IAAIU,OAAO,KACfC,KAAK,YAAa,eAAiBZ,KAAKK,OAAS,KACjDQ,KAZLN,GAAAO,WAAAL,IACIM,UAAUP,QAIbQ,MAAA,cAAA,UAUQA,MAAM,OAAQ,cACdA,MAAM,YAAa,W,oBANxB,WAOH,OAAAT,GAAAU,cAIIC,OAAO,CAAC,EAAE,OACVC,MAAM,CAAEnB,KAAKK,OAAQ,M,yBACzB,WAGG,IAAIe,EAAIpB,KAAKqB,OAAOrB,KAAKK,QAEzBL,KAHJC,IAAAU,OAAA,KACIC,KAAQ,YAAY,mBAEpBC,KAAAN,GAASI,SAATS,GACCR,MAAK,IAMTG,UAAA,QAHIO,aAAaC,SAAS,KACpBP,MAAM,OAAQ,cAIrBA,MAAA,YAAA,W,8BAAA,WACI,OAAOT,GAAGiB,eAKdN,OAAA,CAAA,SAAA,aACaC,MAAQjB,CAAAA,UAAYuB,c,+BADjC,WACI,IAAIC,EAAQ1B,KAAKE,YAAYuB,QAAQE,MAAM,GAC3C,OAGJpB,GAAAqB,QAAAC,KAAAH,EAAAnB,CAAiBP,KAAAE,e,4BAAjB,WACIK,GAAGuB,OAAO,qBACTd,MASL,UAAA,GACIJ,KAAQ,QAAKF,WACbM,MAAQ,mBAAR,SACAA,MAAS,SAAQe,SAEjBf,MAASL,eACRI,OAEAiB,MAAK,gBAHN,OAM6BhB,MAAOP,UAAP,U,0BACc,WACT,IAAAA,EAAQT,KAARU,SAC7BE,EAAKZ,KATVqB,SAUHrB,KAAA+B,mBAVG/B,KAAKC,IAAIU,OAAO,KACfI,UAWL,KAEIiB,KAAK3B,KAALF,QACA8B,QAASrB,OAAK,KAETsB,KAAAA,OAAL,WACHtB,KAAA,IAAA,SAAAuB,GAAA,OAAA1B,EAAA0B,KAXQvB,KAAK,IAAK,SAASuB,GAAK,OAAOf,EAAE,KACjCR,KAAK,SAAU,SAASuB,GAAK,OAAOf,EAAE,KAY/CR,KAAA,QAAAH,EAAA2B,e,mBAII,WAEApC,KAAIsB,MAAU,KAEdtB,KAAKK,OAAQK,IACbV,KAAKC,IAAGW,KAAKS,UAAb,OAAAgB,OAAArC,KAAAI,MAAA,KAAAiC,OAAArC,KAAAK,SAGAL,KAAKsC,iB,wBAZT,WAoBQ,IAAIC,EAAYvC,KAAM8B,oBAEtBU,GADIC,KAAavC,YAAUqC,QAAAA,MAA3B,GACAvC,KACUuC,oBAjBVjB,EAAaf,GAAGe,aAAaC,SAAS,KAuBlCd,EAAIF,KAAGmC,SACXtB,EAAIb,KAAGmC,SACP1C,KAECgB,cALLhB,KAAAsC,cAQA,IAAIK,EAAUpC,GAAGuB,OAAba,qBAAJ3C,KAAA4C,iBA6BR5C,KAAS6C,IAAAA,OAAAA,KAEDC,UAAa,KAvBZd,KAAKe,GA2BVd,QAASe,OAAAA,KACLpC,KAAU,OAAV,SAAAuB,GAAA,OAAAc,EAAAd,EAAAe,OACI5B,UACC6B,QAzBAnB,KAAK,SAASG,GAAK,OAAOA,IA8B5BiB,QAAWC,OAAK,QACnBP,KAAad,IAAb,SAAAG,GAAA,OAAA1B,EAAA0B,EAAAH,KAAAsB,SACAR,KAAWS,IAAQ,SAAApB,GAAC,OAAAf,EAAApB,KAAAK,UAAG8B,KAAEqB,SAAQC,SAAWC,GAAX,OAAkBD,EAAQ,KAA3D7C,KAAA,QAAAH,EAAA2B,aAEAY,GAAAA,YA1CA,SAISrC,GACuB,IAAOsC,EAAP1C,GAAAuB,OAAA9B,KAAA2D,YAAAC,QAAAV,IAC3BnC,EACDoB,EAAAH,KAAAO,GACMC,EAAcqB,KAAAtB,EAAA,cAAAE,GACX9B,MATb,QAUKC,SAAiCuB,aAATZ,SAAA,MAV7BP,MAWe,UAAY,KAgCtBd,GAAAA,YA/Be,SAAAiC,GAAc,IAAQ1B,EAARF,GAAAmC,MAAAjC,EAC7BG,EAAKL,GAAAmC,MAAUN,EAKSI,EAlB7BxB,MAmBU,OAAUP,EAAA,GAAY,MAAEO,MAAW,MAAOI,EAAE,MAnBtDJ,MAAA,UAAA,KA4CKb,GAAL,aAjDiB,SAASgC,GACtBK,EAAQxB,MAAM,UAAW,KAgDuBmB,WAAPb,GAA7CV,KAAA,IAAA,SAAAuB,GAAA,OAAAf,EAAAe,EAAA,MAEK2B,KAAAA,SAAL,SAAA3B,GAAA,OAAAf,EAAAe,EAAA,IAAAf,EAAAe,EAAA,U,KAtBR,SAASU,wBAAwB5C,EAAImD,GAEjC,IAAIN,EAAa,GAEbiB,EAAO,IAAIlE,2BAA2BI,GAU1CM,GAAGyD,IAAIZ,GAAWC,KAAK,SAAArB,IACnBc,EAAad,GACFuB,QAAQ,SAAApB,GAAC,OAAGA,EAAEqB,MAAQC,SAAStB,EAAEuB,OAAOD,SAAStB,EAAE8B,QAT9DhE,EAAIe,MAAM,UAAW,GACrBf,EAAIqB,aACC6B,MAAM,IACN5B,SAAS,KACTP,MAAM,UAAW,GAQtB+C,EAAK7D,YAAc4C,EACnBiB,EAAK5D,OAASI,GAAG2D,IAAIpB,EAAY,SAASX,GAAG,OAAOA,EAAEmB,QAASzB,OAE/DkC,EAAKD","file":"busiest_month_bar.js","sourcesContent":["class BusiestMonthStackedBarPlot {\n    constructor(svgElement) {\n        this.svg = svgElement;\n        this.currentData = {};\n        this.MONTHS = {};\n        this.width = 0;\n        this.height = 0;\n        this.setup();\n    }\n\n    xScale() {\n        return d3.scaleBand()\n        .domain(this.MONTHS)\n        .range([ 0, this.width ])\n        .padding(0.4);\n    }\n\n    createXaxis() {\n        var x = this.xScale(this.width) ;\n\n        this.svg.append(\"g\")\n        .attr(\"transform\", \"translate(0,\" + this.height + \")\")\n        .call(d3.axisBottom(x))\n        .selectAll(\"text\")\n            .style(\"text-anchor\", \"middle\")\n            .style('fill', 'whitesmoke')\n            .style('font-size', '1.6em');\n    }\n\n    yScale() {\n        return d3.scaleLinear()\n        .domain([0,2500])\n        .range([ this.height, 0]);\n    }\n\n    createYaxis() {\n        var y = this.yScale(this.height);\n\n        this.svg.append(\"g\")\n        .attr(\"transform\", \"translate(40,0)\")\n        .call(d3.axisLeft(y).ticks(4))\n        .selectAll(\"text\")\n        .transition().duration(100)\n          .style('fill', 'whitesmoke')\n          .style('font-size', '1.3em');\n    }\n\n    createColorRange() {\n        return d3.scaleOrdinal()\n                .domain(['Movies', 'TV Shows'])\n                .range(['#DB0000', '#623A63']);\n    }\n\n    createStackedData() {\n        var types = this.currentData.columns.slice(1) ;\n        return d3.stack().keys(types)(this.currentData);\n    }\n\n    createTooltips() {\n        d3.select('div#busiest-month')\n        .style(\"opacity\", 0)\n        .attr(\"class\", \"tooltip\")\n        .style(\"background-color\", \"white\")\n        .style(\"border\", \"solid\")\n        .style(\"border-width\", \"1px\")\n        .style(\"border-radius\", \"5px\")\n        .style(\"padding\", \"10px\")\n    }\n\n    initiateBars() {\n        var x = this.xScale();\n        var y = this.yScale();\n        var color = this.createColorRange();\n\n        this.svg.append(\"g\")\n        .selectAll(\"g\")\n        // Enter in the stack data = loop key per key = group per group\n        .data(this.MONTHS)\n        .enter().append(\"g\")\n            .attr(\"fill\", '#ffffff')\n            .attr(\"x\", function(d) { return x(d); })\n            .attr(\"y\", function(d) { return y(0); })\n            .attr(\"height\", function(d) { return y(0); })\n            .attr(\"width\",x.bandwidth());\n    }\n\n    setup() {\n        this.width = 1350 ;\n        this.height = 350;\n        this.svg.attr('viewBox', `0 0 ${this.width} ${this.height}`);\n\n        this.initiateBars() ;\n    }\n\n    updateData() {\n\n        var stackedData = this.createStackedData();\n        var types = this.currentData.columns.slice(1);\n        var color = this.createColorRange();\n\n        var transition = d3.transition().duration(2000);\n\n        var x = this.xScale();\n        var y = this.yScale();\n\n        this.createXaxis();\n        this.createYaxis();\n\n        var tooltip = d3.select('div#busiest-month');\n\n        this.createTooltips();\n\n        //setup tooltip\n        var mouseover = function(d) {\n            var subgroupName = d3.select(this.parentNode).datum().key;\n            var subgroupValue = d.data[subgroupName];\n            tooltip\n                .html(subgroupName + \"<br>\" + \"Count: \" + subgroupValue)\n                .style('color', 'black')\n                .transition().duration(2100)\n                .style('opacity', 1)\n          }\n        var mousemove = function(d) {\n            var x = d3.event.x,\n            y = d3.event.y;\n            tooltip\n            .style(\"left\", (x + 10) + \"px\") // It is important to put the +10: other wise the tooltip is exactly where the point is an it creates a weird effect\n            .style(\"top\", y + \"px\")\n            .style('opacity',0)\n        }\n        var mouseleave = function(d) {\n            tooltip.style(\"opacity\", 0)\n        }\n\n\n        this.svg.append(\"g\")\n        .selectAll(\"g\")\n        // Enter in the stack data = loop key per key = group per group\n        .data(stackedData)\n        .enter().append(\"g\")\n            .attr(\"fill\", function(d) { return color(d.key); })\n            .selectAll(\"rect\")\n            // enter a second time = loop subgroup per subgroup to add all rectangles\n            .data(function(d) { return d; })\n            .enter().append(\"rect\")\n            .attr(\"x\", function(d) { return x(d.data.month); })\n            .attr(\"y\", function(d) { return y(this.height); })\n            .attr(\"height\", function(d) { return y(0); })\n            .attr(\"width\",x.bandwidth())\n            .on(\"mouseover\", mouseover)\n            .on(\"mousemove\", mousemove)\n            .on(\"mouseleave\", mouseleave)\n            .transition(transition)\n            .attr(\"y\", function(d) { return y(d[1]); })\n            .attr(\"height\", function(d) { return y(d[0]) - y(d[1]); })\n    }\n}\n\n\nfunction instentiateBusiestMonth(svg,data_path) {\n\n    let loadedData = {};\n\n    let plot = new BusiestMonthStackedBarPlot(svg);\n\n    function showInitialPlot() {\n        svg.style('opacity', 0);\n        svg.transition()\n            .delay(10)\n            .duration(600)\n            .style('opacity', 1);\n    }\n\n    d3.csv(data_path).then(data => {\n        loadedData = data;\n        loadedData.forEach(d=> d.total = parseInt(d.movie)+parseInt(d.show));\n\n        showInitialPlot();\n        plot.currentData = loadedData;\n        plot.MONTHS = d3.map(loadedData, function(d){return(d.month)}).keys();\n\n        plot.updateData();\n    });\n}\n"]}