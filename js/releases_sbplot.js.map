{"version":3,"sources":["releases_sbplot.js"],"names":["$","margin","top","left","d3","select","append","width","right","height","bottom","svg","data","csv","month","keys","columns","slice","x","scaleBand","domain","range","d","padding","scaleLinear","color","stackedData","stack","call","axisBottom","selectAll","attr","tooltip","style","mouseover","html","mousemove","event","y","scaleOrdinal","mouseleave","bandwidth","enter","key","on","subgroupName","this","parentNode","datum","subgroupValue"],"mappings":"aAAAA,EAAE,WAEA,IAAAC,EAAA,GAAAA,EAAA,GAAAA,EAAA,GAAAA,EAAA,GACIA,EAAM,KAAGA,EAAAA,EAACC,EAAD,IAAAD,EAAAA,EAAiCE,EAAMC,GAAAC,OAAA,kBAApDC,OAAA,OACIC,KAAK,QAAUN,EAAOE,EAAcK,GACpCC,KAAM,SAASR,EAANA,EAA0BS,GAOpCJ,OAAO,KAJNK,KAAMP,YAQH,aAAAH,EAA0B,IAASW,EAAM,KAG9CR,GAAAS,IAAIC,yBAAqB,SAAWF,GAAiB,IAAEG,EAAvDH,EAAAI,QAAAC,MAAA,GACIC,EAAOC,GAAAA,IAAAA,EACNC,SAAON,GACPO,OAAQC,EAAFR,QACNS,OACDjB,EAAAA,GAAOa,YAHNC,OAAON,GAaPO,MAAMG,CAAAA,EAAAA,IAGPlB,QAAO,IAMXK,EAAIc,OAAK,KAILC,KAAAA,YAAiBC,eAElBf,EAGH,KACEgB,KAAAxB,GAAAyB,WAAAX,IACAY,UAAA,QA1BOC,KAAK,YAAa,+BA2BrBC,MAAU5B,cAAU,OAzBjB6B,MAAM,OAAQ,cAoCjBC,MAAS,YAATA,UAGFF,IAAAA,EAAAA,GACKG,cAJPf,OAAA,CAAA,EAAA,MA9BGC,MAAM,CAAEZ,EAAQ,IAsCnBE,EAAIyB,OAAAA,KACFR,KAAQxB,GAAGiC,SAAXC,IAAAR,UACOO,QACPL,MACCC,OAAM,cACNA,MAAM,YAFP,UAlCJ,IAAIR,EAAQrB,GAAGmC,eAsCbnB,OAAIoB,GACFR,MAAO,CACJC,UAAM,YApCTP,EAActB,GAAGuB,QAuClBZ,KAACT,EAvCcF,CA0CfQ,GAO4BoB,EAAWpB,GAAKE,OAAhB,kBACxBiB,OAXP,OAW+BE,MAASX,UAAT,GACxBS,KAAK,QAAU,WAAcE,MAASX,mBAAT,SAC7BS,MAAK,SAAUU,SAnFxBR,MAAA,eAAA,OAhBFA,MAAA,gBAAA,OA+DSA,MAAM,UAAW,QAuBtBtB,EAAIL,OAAO,KACRwB,UAAU,KAEVlB,KAAKc,GACLgB,QAAQpC,OAAO,KACbyB,KAAK,OAAQ,SAAST,GAAK,OAAOG,EAAMH,EAAEqB,OAC1Cb,UAAU,QAEVlB,KAAK,SAASU,GAAK,OAAOA,IAC1BoB,QAAQpC,OAAO,QACbyB,KAAK,IAAK,SAAST,GAAK,OAAOJ,EAAEI,EAAEV,KAAKE,SACxCiB,KAAK,IAAK,SAAST,GAAK,OAAOgB,EAAEhB,EAAE,MACnCS,KAAK,SAAU,SAAST,GAAK,OAAOgB,EAAEhB,EAAE,IAAMgB,EAAEhB,EAAE,MAClDS,KAAK,QAAQb,EAAEuB,aACjBG,GAAG,YAlCU,SAAStB,GACvB,IAAIuB,EAAezC,GAAGC,OAAOyC,KAAKC,YAAYC,QAAQL,IAClDM,EAAgB3B,EAAEV,KAAKiC,GAC3Bb,EACKG,KAAKU,EAAe,cAAqBI,GACzChB,MAAM,UAAW,GACjBA,MAAM,QAAS,WA6BnBW,GAAG,YA3BU,SAAStB,GACvB,IAAIJ,EAAId,GAAGiC,MAAMnB,EACjBoB,EAAIlC,GAAGiC,MAAMC,EACbN,EACCC,MAAM,OAASf,EAAI,GAAM,MACzBe,MAAM,MAAOK,EAAI,QAuBjBM,GAAG,aArBW,SAAStB,GACxBU,EACGC,MAAM,UAAW","file":"releases_sbplot.js","sourcesContent":["$(function() {\n\n  // set the dimensions and margins of the graph\n  var margin = {top: 10, right: 30, bottom: 50, left: 50},\n      width = 1350 - margin.left - margin.right,\n      height = 450 - margin.top - margin.bottom;\n\n  // append the svg object to the body of the page\n  var svg = d3.select(\"#busiest-month\")\n    .append(\"svg\")\n      .attr(\"width\", width + margin.left + margin.right)\n      .attr(\"height\", height + margin.top + margin.bottom)\n    .append(\"g\")\n      .attr(\"transform\",\n            \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n  d3.csv(\"data/busiest_month.csv\", function(data) {\n\n    var type = data.columns.slice(1);\n    var month = d3.map(data, function(d){return(d.month)}).keys()\n    var x = d3.scaleBand()\n        .domain(month)\n        .range([ 0, width ])\n        .padding(0.4);\n    svg.append(\"g\")\n        .attr(\"transform\", \"translate(0,\" + height + \")\")\n        .call(d3.axisBottom(x))\n        .selectAll(\"text\")\n            .attr(\"transform\", \"translate(-10,0)rotate(-45)\")\n            .style(\"text-anchor\", \"end\")\n            .style('fill', 'whitesmoke')\n            .style('font-size', '0.7rem')\n\n    // Add Y axis\n    var y = d3.scaleLinear()\n        .domain([0, 2000])\n        .range([ height, 0]);\n    svg.append(\"g\")\n        .call(d3.axisLeft(y))\n        .selectAll(\"text\")\n          .style('fill', 'whitesmoke')\n          .style('font-size', '0.7rem');\n\n    var color = d3.scaleOrdinal()\n      .domain(type)\n      .range(['#DB0000', '#623A63']);\n\n    var stackedData = d3.stack()\n      .keys(type)\n      (data)\n\n\n    // ----------------\n      // Create a tooltip\n      // ----------------\n      var tooltip = d3.select(\"#busiest-month\")\n        .append(\"div\")\n        .style(\"opacity\", 0)\n        .attr(\"class\", \"tooltip\")\n        .style(\"background-color\", \"white\")\n        .style(\"border\", \"solid\")\n        .style(\"border-width\", \"1px\")\n        .style(\"border-radius\", \"5px\")\n        .style(\"padding\", \"10px\")\n\n      // Three function that change the tooltip when user hover / move / leave a cell\n      var mouseover = function(d) {\n        var subgroupName = d3.select(this.parentNode).datum().key;\n        var subgroupValue = d.data[subgroupName];\n        tooltip\n            .html(subgroupName + \"<br>\" + \"Count: \" + subgroupValue)\n            .style(\"opacity\", 1)\n            .style('color', 'black')\n      }\n      var mousemove = function(d) {\n        var x = d3.event.x,\n        y = d3.event.y;\n        tooltip\n        .style(\"left\", (x + 10) + \"px\") // It is important to put the +90: other wise the tooltip is exactly where the point is an it creates a weird effect\n        .style(\"top\", y + \"px\")\n      } \n      var mouseleave = function(d) {\n        tooltip\n          .style(\"opacity\", 0)\n      }\n\n    svg.append(\"g\")\n      .selectAll(\"g\")\n      // Enter in the stack data = loop key per key = group per group\n      .data(stackedData)\n      .enter().append(\"g\")\n        .attr(\"fill\", function(d) { return color(d.key); })\n        .selectAll(\"rect\")\n        // enter a second time = loop subgroup per subgroup to add all rectangles\n        .data(function(d) { return d; })\n        .enter().append(\"rect\")\n          .attr(\"x\", function(d) { return x(d.data.month); })\n          .attr(\"y\", function(d) { return y(d[1]); })\n          .attr(\"height\", function(d) { return y(d[0]) - y(d[1]); })\n          .attr(\"width\",x.bandwidth())\n        .on(\"mouseover\", mouseover)\n        .on(\"mousemove\", mousemove)\n        .on(\"mouseleave\", mouseleave)\n  })\n})"]}